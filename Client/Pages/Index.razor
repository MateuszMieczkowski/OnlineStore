@page "/"
@inject IJSRuntime jsRuntime
@inject HttpClient Http
@using System.Text.Json
@using System.Net
@using System.Net.Http.Headers
@using SneakerBase.Shared.Dtos
<section class="jumbotron text-left">
    <div class="container">
        <form id="filter">
            <div class="col-sm-8">
                <div class="form-group">
                    <label for="inputSearchFilter">Search:</label>
                    <input type="text" class="form-control" id="inputSearchFilter">
                </div>
                <button type="reset" class="btn btn-outline-dark">Clear</button>
            </div>
        </form>
    </div>
</section>

@if (products == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <div class="container" style="max-width: 90%">

        <div class="row ">

            @foreach (var product in products)
            {
                <div class="col-md-2">
                    <div class="card mb-5 ml-2">
                        <img class="img-thumbnail" src=@product.ThumbnailPath alt="Sneaker image" @onclick="() => Toggle(product)">
                        <div class="card-body">
                            <p class="card-text">@product.Name</p>
                            <p class="card-text">@product.ReferenceNumber</p>
                            <p class="card-text">Quantity: @product.Quantity</p>
                            <button @onclick="() => Toggle(product)" type="button" class="btn btn-outline-dark show"> @(product.IsHidden  ? "Details" : "Hide")</button>
                            <div id="info" hidden="@product.IsHidden">
                                <p class="card-text mt-2">Available sizes:</p>
                                <ul class="list-group">
                                    @foreach (var size in product.AvailableSizes)
                                    {
                                        <li class="list-group-item">@size.Size x @size.Quantity</li>
                                    }

                                </ul>
                            </div>


                        </div>
                    </div>
                </div>
            }

        </div>

    </div>

}

@code {

    [Parameter]
    public bool IsHidden { get; set; } = true;

    private List<ProductDto>? products;
    private string errorMessage;

    protected override async Task OnInitializedAsync()
    {
        products = await Http.GetFromJsonAsync<List<ProductDto>>("/api/products");
    }

    private void Toggle(ProductDto product)
    {
        product.IsHidden = !product.IsHidden;
    }


}



